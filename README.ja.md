<p align="right">
<a href="./README.md">Chinese</a> | <a href="./README.en.md">English</a> | <a href="./README.fr.md">Fran√ßais</a> | <strong>Japanese</strong></p>

> [!NOTE]
> **MT (Machine Translation)**: This document has been machine translated. For the most accurate information, please refer to the [Chinese version](./README.md).
<div align="center">

![new-api](/web/public/logo.png)

# New API

Next-generation large-scale model gateway and AI asset management system
<a href="https://trendshift.io/repositories/8227" target="_blank"><img src="https://trendshift.io/api/badge/repositories/8227" alt="Calcium-Ion%2Fnew-api | Trendshift" style="width: 250px; height: 55px;" width="250" height="55"/></a>

<p align="center">
  <a href="https://raw.githubusercontent.com/Calcium-Ion/new-api/main/LICENSE">
    <img src="https://img.shields.io/github/license/Calcium-Ion/new-api?color=brightgreen" alt="license">
  </a>
  <a href="https://github.com/Calcium-Ion/new-api/releases/latest">
    <img src="https://img.shields.io/github/v/release/Calcium-Ion/new-api?color=brightgreen&include_prereleases" alt="release">
  </a>
  <a href="https://github.com/users/Calcium-Ion/packages/container/package/new-api">
    <img src="https://img.shields.io/badge/docker-ghcr.io-blue" alt="docker">
  </a>
  <a href="https://hub.docker.com/r/CalciumIon/new-api">
    <img src="https://img.shields.io/badge/docker-dockerHub-blue" alt="docker">
  </a>
  <a href="https://goreportcard.com/report/github.com/Calcium-Ion/new-api">
    <img src="https://goreportcard.com/badge/github.com/Calcium-Ion/new-api" alt="GoReportCard">
  </a>
</p>
</div>

## üìù Project Description
> [!NOTE]  
> This project is an open-source project developed based on [One API](https://github.com/songquanpeng/one-api).
> [!IMPORTANT]  
> - This project is for personal learning purposes only and does not provide stability guarantees or technical support.- Users must comply with OpenAI's [Terms of Use](https://openai.com/policies/terms-of-use) and **legal regulations**, and must not use it for illegal purposes.- Please do not provide unregistered generative AI services to the public in China in accordance with the requirements of the "Interim Measures for the Management of Generative Artificial Intelligence Services".
<h2>ü§ù Trusted Partner</h2><p id="premium-sponsors">&nbsp;</p>
<p align="center"><strong>Order does not matter</strong></p><p align="center">
  <a href="https://www.cherry-ai.com/" target=_blank><img
    src="./docs/images/cherry-studio.png" alt="Cherry Studio" height="120"
  /></a>
  <a href="https://bda.pku.edu.cn/" target=_blank><img
src="./docs/images/pku.png" alt="Peking University" height="120"  /></a>
  <a href="https://www.compshare.cn/?ytag=GPU_yy_gh_newapi" target=_blank><img
src="./docs/images/ucloud.png" alt="UCloud" height="120"  /></a>
  <a href="https://www.aliyun.com/" target=_blank><img
    src="./docs/images/aliyun.png" alt="Alibaba Cloud" height="120"
  /></a>
  <a href="https://io.net/" target=_blank><img
    src="./docs/images/io-net.png" alt="IO.NET" height="120"
  /></a>
</p>
<p>&nbsp;</p>

## üìö „Éâ„Ç≠„É•„É°„É≥„Éà

For detailed documentation, please refer to the official Wiki: [https://docs.newapi.pro/](https://docs.newapi.pro/)
You can also access the DeepWiki generated by AI:[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/QuantumNous/new-api)

## ‚ú® Main Features
The new API offers a wealth of features. For detailed functionality, please refer to the [feature description](https://docs.newapi.pro/wiki/features-introduction):
1. üé® A completely new UI interface2. üåç Multilingual Support3. üí∞ Supports online charging function, currently supports EPay and Stripe.4. Supports usage quota inquiries by key (integrated with [neko-api-key-tool](https://github.com/Calcium-Ion/neko-api-key-tool))5. üîÑ Compatible with the original One API database6. üíµ Supports pay-as-you-go billing for models7. ‚öñÔ∏è Supports weighted random channel selection8. üìà „Éá„Éº„Çø„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâÔºà„Ç≥„É≥„ÇΩ„Éº„É´Ôºâ
9. üîí Token grouping, model restrictions10. ü§ñ Support for more authentication login methods (LinuxDO, Telegram, OIDC)11. üîÑ Rerank„É¢„Éá„É´„Çí„Çµ„Éù„Éº„ÉàÔºàCohere„Å®JinaÔºâ„ÄÅ[API „Éâ„Ç≠„É•„É°„É≥„Éà](https://docs.newapi.pro/api/jinaai-rerank)
12. ‚ö° Supports OpenAI Realtime API (including Azure channel), [API documentation](https://docs.newapi.pro/api/openai-realtime)13. ‚ö° **Supports OpenAI Responses**, [API Documentation](https://docs.newapi.pro/api/openai-responses)14. ‚ö° Supports **Claude Messages**, [API documentation](https://docs.newapi.pro/api/anthropic-chat)15. ‚ö° Supports **Google Gemini** format, [API documentation](https://docs.newapi.pro/api/google-gemini-chat/)16. Support setting reasoning effort through the model name suffix:    1. OpenAI o„Ç∑„É™„Éº„Ç∫„É¢„Éá„É´
Add the `-high` suffix to set high reasoning effort (e.g., `o3-mini-high`)Add the `-medium` suffix to set medium reasoning effort (e.g., `o3-mini-medium`)Add the `-low` suffix to set low reasoning effort (e.g., `o3-mini-low`)2. Claude Thinking ModelAdd the `-thinking` suffix to enable thinking mode (e.g., `claude-3-7-sonnet-20250219-thinking`)17. üîÑ Function from Thought to Content18. üîÑ Model rate limiting feature for users19. üîÑ Request format conversion feature, supporting the following three format conversions:    1. OpenAI Chat Completions => Claude Messages
2. Claude Messages => OpenAI Chat Completions (Claude Code can be used to call third-party models)    3. OpenAI Chat Completions => Gemini Chat
20. üí∞ Cash charging support, when enabled, allows charging at the set rate when cash hits:1. Set the `Prompt Cache Multiplier` option in `System Settings - Operational Settings`.2. Set the `prompt cache multiplier` in the channel, with a range of 0-1. For example, if set to 0.5, it will charge 50% when the cache hits.    3. „Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Çã„ÉÅ„É£„Éç„É´Ôºö
        - [x] OpenAI
        - [x] Azure
        - [x] DeepSeek
        - [x] Claude

## „É¢„Éá„É´„Çµ„Éù„Éº„Éà

This version supports multiple models. For details, please refer to the [API documentation - Relay Interface](https://docs.newapi.pro/api):
1. „Çµ„Éº„Éâ„Éë„Éº„ÉÜ„Ç£„É¢„Éá„É´ **gpts**Ôºàgpt-4-gizmo-*Ôºâ
2. „Çµ„Éº„Éâ„Éë„Éº„ÉÜ„Ç£„ÉÅ„É£„Éç„É´[Midjourney-Proxy(Plus)](https://github.com/novicezk/midjourney-proxy)„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„ÄÅ[API„Éâ„Ç≠„É•„É°„É≥„Éà](https://docs.newapi.pro/api/midjourney-proxy-image)
3. „Çµ„Éº„Éâ„Éë„Éº„ÉÜ„Ç£„ÉÅ„É£„Éç„É´[Suno API](https://github.com/Suno-API/Suno-API)„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„ÄÅ[API„Éâ„Ç≠„É•„É°„É≥„Éà](https://docs.newapi.pro/api/suno-music)
4. Custom channels support full call address input5. Rerank„É¢„Éá„É´Ôºà[Cohere](https://cohere.ai/)„Å®[Jina](https://jina.ai/)Ôºâ„ÄÅ[API„Éâ„Ç≠„É•„É°„É≥„Éà](https://docs.newapi.pro/api/jinaai-rerank)
6. Claude Messages format, [API documentation](https://docs.newapi.pro/api/anthropic-chat)7. Google Gemini format, [API documentation](https://docs.newapi.pro/api/google-gemini-chat/)8. Dify currently supports only chatflow.9. For other interfaces, please refer to the [API documentation](https://docs.newapi.pro/api).
## Environment Variable Settings
For detailed configuration instructions, please refer to the [Installation Guide - Environment Variable Settings](https://docs.newapi.pro/installation/environment-variables):
- `GENERATE_DEFAULT_TOKEN`: Whether to generate an initial token for newly registered users, default is `false`- `STREAMING_TIMEOUT`: The timeout duration for streaming responses, default is 300 seconds.- `DIFY_DEBUG`: Whether the Dify channel outputs workflow and node information, default is `true`- `GET_MEDIA_TOKEN`: Whether to collect image tokens, default is `true`- `GET_MEDIA_TOKEN_NOT_STREAM`: Whether to collect image tokens when not streaming, default is `true`- `UPDATE_TASK`: Whether to update asynchronous tasks (Midjourney, Suno), default is `true`- `GEMINI_VISION_MAX_IMAGE_NUM`: Maximum number of images for the Gemini model, default is `16`- `MAX_FILE_DOWNLOAD_MB`: Maximum file download size, in MB, default is `20`- `CRYPTO_SECRET`: Encryption key used to encrypt the contents of the Redis database.- `AZURE_DEFAULT_API_VERSION`ÔºöAzure„ÉÅ„É£„Éç„É´„ÅÆ„Éá„Éï„Ç©„É´„Éà„ÅÆ„Éê„Éº„Ç∏„Éß„É≥„ÄÅ„Éá„Éï„Ç©„É´„Éà„ÅØ`2025-04-01-preview`
- `NOTIFICATION_LIMIT_DURATION_MINUTE`: Duration of notification limits such as emails, default is `10` minutes.- `NOTIFY_LIMIT_COUNT`: The maximum number of user notifications within the specified duration, default is `2`.- `ERROR_LOG_ENABLED=true`: Whether to record and display error logs, default is `false`
## „Éá„Éó„É≠„Ç§

For detailed deployment instructions, please refer to the [Installation Guide - Deployment Method](https://docs.newapi.pro/installation):
> [!TIP]
Latest Docker image: `calciumion/new-api:latest`
### Notes on Multi-Machine Deployment- You need to set the environment variable `SESSION_SECRET`. Otherwise, the login state will be inconsistent during multi-machine deployment.- When sharing Redis, you need to set `CRYPTO_SECRET`. Otherwise, you won't be able to retrieve the contents of Redis during multi-machine deployment.
### Deployment Requirements- Local database (default): SQLite (for Docker deployment, you need to mount the `/data` directory)- „É™„É¢„Éº„Éà„Éá„Éº„Çø„Éô„Éº„ÇπÔºöMySQL„Éê„Éº„Ç∏„Éß„É≥ >= 5.7.8„ÄÅPgSQL„Éê„Éº„Ç∏„Éß„É≥ >= 9.6

### Deployment Method
#### Deploy using the Docker feature of the Baota panelInstall the Baota panel (**version 9.2.0 or higher**) and find and install **New-API** in the application store.[Image Tutorial](./docs/BT.md)
#### Deploy using Docker Compose (recommended)```shell
# „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
git clone https://github.com/Calcium-Ion/new-api.git
cd new-api
# Edit docker-compose.yml as necessary# Startdocker-compose up -d
```

#### Use Docker image directly```shell
# Using SQLitedocker run --name new-api -d --restart always -p 3000:3000 -e TZ=Asia/Shanghai -v /home/ubuntu/data/new-api:/data calciumion/new-api:latest

# Using MySQLdocker run --name new-api -d --restart always -p 3000:3000 -e SQL_DSN="root:123456@tcp(localhost:3306)/oneapi" -e TZ=Asia/Shanghai -v /home/ubuntu/data/new-api:/data calciumion/new-api:latest
```

## „ÉÅ„É£„Éç„É´„É™„Éà„É©„Ç§„Å®„Ç≠„É£„ÉÉ„Ç∑„É•
The channel retry feature has already been implemented, and you can set the retry count in `Settings -> Operational Settings -> General Settings -> Failure Retry Count`. **It is recommended to enable the cache feature**.
### Cache Configuration Method1. `REDIS_CONN_STRING`: Set Redis as the cache2. `MEMORY_CACHE_ENABLED`: Enable memory cache (no manual configuration needed if Redis is set up)
## API„Éâ„Ç≠„É•„É°„É≥„Éà

For detailed API documentation, please refer to the [API Documentation](https://docs.newapi.pro/api):
- [„ÉÅ„É£„ÉÉ„Éà„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπÔºàChat CompletionsÔºâ](https://docs.newapi.pro/api/openai-chat)
- [„É¨„Çπ„Éù„É≥„Çπ„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπÔºàResponsesÔºâ](https://docs.newapi.pro/api/openai-responses)
- [Image Interface (Image)](https://docs.newapi.pro/api/openai-image)- [Rerank Interface](https://docs.newapi.pro/api/jinaai-rerank)- [Real-time Dialogue Interface (Realtime)](https://docs.newapi.pro/api/openai-realtime)- [Claude„ÉÅ„É£„ÉÉ„Éà„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ](https://docs.newapi.pro/api/anthropic-chat)
- [Google Gemini„ÉÅ„É£„ÉÉ„Éà„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ](https://docs.newapi.pro/api/google-gemini-chat)

## Related Projects- [One API](https://github.com/songquanpeng/one-api)Ôºö„Ç™„É™„Ç∏„Éä„É´„Éó„É≠„Ç∏„Çß„ÇØ„Éà
- [Midjourney-Proxy](https://github.com/novicezk/midjourney-proxy)ÔºöMidjourney„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„Çµ„Éù„Éº„Éà
- [neko-api-key-tool](https://github.com/Calcium-Ion/neko-api-key-tool): Query usage quota using the key
Other projects based on the new API:- [new-api-horizon](https://github.com/Calcium-Ion/new-api-horizon): New API high-performance optimized version
## „Éò„É´„Éó„Çµ„Éù„Éº„Éà

If you have any issues, please refer to [Help Support](https://docs.newapi.pro/support):- [Community Interaction](https://docs.newapi.pro/support/community-interaction)- [Feedback on Issues](https://docs.newapi.pro/support/feedback-issues)- [Frequently Asked Questions](https://docs.newapi.pro/support/faq)
## üåü Star History

[![Star History Chart](https://api.star-history.com/svg?repos=Calcium-Ion/new-api&type=Date)](https://star-history.com/#Calcium-Ion/new-api&Date)

